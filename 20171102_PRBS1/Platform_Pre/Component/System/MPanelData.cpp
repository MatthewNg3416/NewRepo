/* Generated by Together */
#include "stdafx.h"
#include "common.h"
#include "MPanelData.h"
#include "MyProgressWnd.h"

#ifdef _DEBUG
#undef THIS_FILE
static char THIS_FILE[]=__FILE__;
#define new DEBUG_NEW
#endif

MPanelData::MPanelData()
{
	initialize();
}

MPanelData::MPanelData(CString strFileName) : MFileManager(strFileName)
{
	initialize();
}

MPanelData::MPanelData(CString strFileName, CString strPath): MFileManager(strFileName, strPath)
{
	initialize();
}

void MPanelData::initialize()
{
	m_dPanelSize_X				= 0.0;				
    m_dPanelSize_Y				= 0.0;				

	m_bUseFlag_Xu = FALSE;
    m_bUseFlag_SubMark_Xu	= FALSE;		
    m_dX_FiduMark_Xu			= 0.0;			
    m_dY_FiduMark_Xu			= 0.0;		
    m_dDistance_FiduMark_Xu		= 0.0;	
	m_dX_FiduSubMark_Xu			= 0.0;		
	m_dY_FiduSubMark_Xu			= 0.0;		
	m_dDistance_FiduSubMark_Xu	= 0.0;	
	m_dMarkDist_PanelToTab_Xu	= 0.0;

	m_bUseFlag_Xd = FALSE;
    m_bUseFlag_SubMark_Xd	= FALSE;		
    m_dX_FiduMark_Xd			= 0.0;
    m_dY_FiduMark_Xd			= 0.0;
    m_dDistance_FiduMark_Xd		= 0.0;
	m_dX_FiduSubMark_Xd			= 0.0;
	m_dY_FiduSubMark_Xd			= 0.0;
	m_dDistance_FiduSubMark_Xd	= 0.0;
	m_dMarkDist_PanelToTab_Xd	= 0.0;

	m_bUseFlag_Yl = FALSE;
    m_bUseFlag_SubMark_Yl	= FALSE;		
    m_dX_FiduMark_Yl			= 0.0;
    m_dY_FiduMark_Yl			= 0.0;
    m_dDistance_FiduMark_Yl		= 0.0;
	m_dX_FiduSubMark_Yl			= 0.0;
	m_dY_FiduSubMark_Yl			= 0.0;
	m_dDistance_FiduSubMark_Yl	= 0.0;
	m_dMarkDist_PanelToTab_Yl	= 0.0;

	m_bUseFlag_Yr = FALSE;
	m_bUseFlag_SubMark_Yr	= FALSE;		
    m_dX_FiduMark_Yr			= 0.0;
    m_dY_FiduMark_Yr			= 0.0;
    m_dDistance_FiduMark_Yr		= 0.0;
	m_dX_FiduSubMark_Yr			= 0.0;
	m_dY_FiduSubMark_Yr			= 0.0;
	m_dDistance_FiduSubMark_Yr	= 0.0;
	m_dMarkDist_PanelToTab_Yr	= 0.0;
   
	m_ePanel_InDirection		= 0;		
	m_ePanel_OutDirection		= 0;		
	m_dPanelThickness			= 0.0;		
	m_dPanelLowSidePolThickness = 0.0;	

	//NSMC KJS
	m_eRunMode					= NORMAL_RUN_MODE;

	//110114.kms
	m_strReferenceDevice		= "";

//@#ifdef DEF_SOURCE_SYSTEM
//@	m_iPanelAlignMode			= 0;
//@#endif

	for (int i=0; i<DEF_MAX_WORK_SCHEDULE; i++)
	{
		for (int j=0; j<DEF_MAX_AIRVACUUM; j++)
		{
			m_bUseAirVacuum[i][j] = TRUE;
		}
	}

	for (int i=0; i<DEF_MAX_THANDLER_VAC; i++)
	{
		m_bUseTHandlerVac[i]	= FALSE;
	}
}

MPanelData::~MPanelData()
{

}

/** Data蒂 File縑憮 檗橫 螃朝 л熱 */
BOOL MPanelData::ReadData()
{
	BOOL	bReturn = TRUE;
	CString	strBuffer;
	CString	strSection = "Panel Data";

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "PanelSize_X", &m_dPanelSize_X))
		DISPLAY_READ_ERROR(strSection, "PanelSize_X", bReturn);
	
	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "PanelSize_Y", &m_dPanelSize_Y))
		DISPLAY_READ_ERROR(strSection, "PanelSize_Y", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "Use_Xu", &strBuffer))
		DISPLAY_READ_ERROR(strSection, "Use_Xu", bReturn);

	if (!strBuffer.Compare(_T("TRUE")))
		m_bUseFlag_Xu = TRUE;
	else
		m_bUseFlag_Xu = FALSE;

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "Use_SubMark_Xu", &strBuffer))
		DISPLAY_READ_ERROR(strSection, "Use_SubMark_Xu", bReturn);

	if (!strBuffer.Compare(_T("TRUE")))
		m_bUseFlag_SubMark_Xu = TRUE;
	else
		m_bUseFlag_SubMark_Xu = FALSE;

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduMark_Xu_Pos_X", &m_dX_FiduMark_Xu))
		DISPLAY_READ_ERROR(strSection, "FiduMark_Xu_Pos_X", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduMark_Xu_Pos_Y", &m_dY_FiduMark_Xu))
		DISPLAY_READ_ERROR(strSection, "FiduMark_Xu_Pos_Y", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduMark_Xu_Distance", &m_dDistance_FiduMark_Xu))
		DISPLAY_READ_ERROR(strSection, "FiduMark_Xu_Distance", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduSubMark_Xu_Pos_X", &m_dX_FiduSubMark_Xu))
		DISPLAY_READ_ERROR(strSection, "FiduSubMark_Xu_Pos_X", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduSubMark_Xu_Pos_Y", &m_dY_FiduSubMark_Xu))
		DISPLAY_READ_ERROR(strSection, "FiduSubMark_Xu_Pos_Y", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduSubMark_Xu_Distance", &m_dDistance_FiduSubMark_Xu))
		DISPLAY_READ_ERROR(strSection, "FiduSubMark_Xu_Distance", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "MarkDist_PanelToTab_Xu", &m_dMarkDist_PanelToTab_Xu))
		DISPLAY_READ_ERROR(strSection, "MarkDist_PanelToTab_Xu", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "Use_Xd", &strBuffer))
		DISPLAY_READ_ERROR(strSection, "Use_Xd", bReturn);

	if (!strBuffer.Compare(_T("TRUE")))
		m_bUseFlag_Xd = TRUE;
	else
		m_bUseFlag_Xd = FALSE;

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "Use_SubMark_Xd", &strBuffer))
		DISPLAY_READ_ERROR(strSection, "Use_SubMark_Xd", bReturn);

	if (!strBuffer.Compare(_T("TRUE")))
		m_bUseFlag_SubMark_Xd = TRUE;
	else
		m_bUseFlag_SubMark_Xd = FALSE;

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduMark_Xd_Pos_X", &m_dX_FiduMark_Xd))
		DISPLAY_READ_ERROR(strSection, "FiduMark_Xd_Pos_X", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduMark_Xd_Pos_Y", &m_dY_FiduMark_Xd))
		DISPLAY_READ_ERROR(strSection, "FiduMark_Xd_Pos_Y", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduMark_Xd_Distance", &m_dDistance_FiduMark_Xd))
		DISPLAY_READ_ERROR(strSection, "FiduMark_Xd_Distance", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduSubMark_Xd_Pos_X", &m_dX_FiduSubMark_Xd))
		DISPLAY_READ_ERROR(strSection, "FiduSubMark_Xd_Pos_X", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduSubMark_Xd_Pos_Y", &m_dY_FiduSubMark_Xd))
		DISPLAY_READ_ERROR(strSection, "FiduSubMark_Xd_Pos_Y", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduSubMark_Xd_Distance", &m_dDistance_FiduSubMark_Xd))
		DISPLAY_READ_ERROR(strSection, "FiduSubMark_Xd_Distance", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "MarkDist_PanelToTab_Xd", &m_dMarkDist_PanelToTab_Xd))
		DISPLAY_READ_ERROR(strSection, "MarkDist_PanelToTab_Xd", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "Use_Yl", &strBuffer))
		DISPLAY_READ_ERROR(strSection, "Use_Yl", bReturn);

	if (!strBuffer.Compare(_T("TRUE")))
		m_bUseFlag_Yl = TRUE;
	else
		m_bUseFlag_Yl = FALSE;

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "Use_SubMark_Yl", &strBuffer))
		DISPLAY_READ_ERROR(strSection, "Use_SubMark_Yl", bReturn);

	if (!strBuffer.Compare(_T("TRUE")))
		m_bUseFlag_SubMark_Yl = TRUE;
	else
		m_bUseFlag_SubMark_Yl = FALSE;

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduMark_Yl_Pos_X", &m_dX_FiduMark_Yl))
		DISPLAY_READ_ERROR(strSection, "FiduMark_Yl_Pos_X", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduMark_Yl_Pos_Y", &m_dY_FiduMark_Yl))
		DISPLAY_READ_ERROR(strSection, "FiduMark_Yl_Pos_Y", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduMark_Yl_Distance", &m_dDistance_FiduMark_Yl))
		DISPLAY_READ_ERROR(strSection, "FiduMark_Yl_Distance", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduSubMark_Yl_Pos_X", &m_dX_FiduSubMark_Yl))
		DISPLAY_READ_ERROR(strSection, "FiduSubMark_Yl_Pos_X", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduSubMark_Yl_Pos_Y", &m_dY_FiduSubMark_Yl))
		DISPLAY_READ_ERROR(strSection, "FiduSubMark_Yl_Pos_Y", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduSubMark_Yl_Distance", &m_dDistance_FiduSubMark_Yl))
		DISPLAY_READ_ERROR(strSection, "FiduSubMark_Yl_Distance", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "MarkDist_PanelToTab_Yl", &m_dMarkDist_PanelToTab_Yl))
		DISPLAY_READ_ERROR(strSection, "MarkDist_PanelToTab_Yl", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "Use_Yr", &strBuffer))
		DISPLAY_READ_ERROR(strSection, "Use_Yr", bReturn);

	if (!strBuffer.Compare(_T("TRUE")))
		m_bUseFlag_Yr = TRUE;
	else
		m_bUseFlag_Yr = FALSE;

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "Use_SubMark_Yr", &strBuffer))
		DISPLAY_READ_ERROR(strSection, "Use_SubMark_Yr", bReturn);

	if (!strBuffer.Compare(_T("TRUE")))
		m_bUseFlag_SubMark_Yr = TRUE;
	else
		m_bUseFlag_SubMark_Yr = FALSE;

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduMark_Yr_Pos_X", &m_dX_FiduMark_Yr))
		DISPLAY_READ_ERROR(strSection, "FiduMark_Yr_Pos_X", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduMark_Yr_Pos_Y", &m_dY_FiduMark_Yr))
		DISPLAY_READ_ERROR(strSection, "FiduMark_Yr_Pos_Y", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduMark_Yr_Distance", &m_dDistance_FiduMark_Yr))
		DISPLAY_READ_ERROR(strSection, "FiduMark_Yr_Distance", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduSubMark_Yr_Pos_X", &m_dX_FiduSubMark_Yr))
		DISPLAY_READ_ERROR(strSection, "FiduSubMark_Yr_Pos_X", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduSubMark_Yr_Pos_Y", &m_dY_FiduSubMark_Yr))
		DISPLAY_READ_ERROR(strSection, "FiduSubMark_Yr_Pos_Y", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "FiduSubMark_Yr_Distance", &m_dDistance_FiduSubMark_Yr))
		DISPLAY_READ_ERROR(strSection, "FiduSubMark_Yr_Distance", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "MarkDist_PanelToTab_Yr", &m_dMarkDist_PanelToTab_Yr))
		DISPLAY_READ_ERROR(strSection, "MarkDist_PanelToTab_Yr", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "Panel_Input_Direction", &strBuffer))
		DISPLAY_READ_ERROR(strSection, "Panel_Input_Direction", bReturn);

	if (!strBuffer.Compare(_T("NORMAL")))
		m_ePanel_InDirection = INPUT_DIRECTION_NORMAL;
	else
		m_ePanel_InDirection = INPUT_DIRECTION_REVERSE;

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "Panel_Output_Direction", &strBuffer))
		DISPLAY_READ_ERROR(strSection, "Panel_Output_Direction", bReturn);

	if (!strBuffer.Compare(_T("NORMAL")))
		m_ePanel_OutDirection = OUTPUT_DIRECTION_NORMAL;
	else
		m_ePanel_OutDirection = OUTPUT_DIRECTION_REVERSE;

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "Panel_Thickness", &m_dPanelThickness))
		DISPLAY_READ_ERROR(strSection, "Panel_Thickness", bReturn);

	//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
	if (!GetValue(strSection, "Panel_LowSide_Pol_Thickness", &m_dPanelLowSidePolThickness))
		DISPLAY_READ_ERROR(strSection, "Panel_LowSide_Pol_Thickness", bReturn);

	//110114.kms
	/** Reference Data **/
	if (!GetValue(strSection, "Reference_Data", &m_strReferenceDevice))
		DISPLAY_READ_ERROR(strSection, "Reference_Data", bReturn);


//@#ifdef DEF_SOURCE_SYSTEM
//@	if (!GetValue(strSection, "PanelAlignMode", &m_iPanelAlignMode))
//@		DISPLAY_READ_ERROR(strSection, "PanelAlignMode", bReturn);
//@#endif

	CString strItem;
	for (int i=0; i<DEF_MAX_WORK_SCHEDULE; i++)
	{
		for (int j=0; j<DEF_MAX_AIRVACUUM; j++)
		{
			strItem.Format(_T("UseAirVacuum_%d_%d"), i, j);
			if (!GetValue(m_strSection, strItem, &m_bUseAirVacuum[i][j]))
			{
				DISPLAY_READ_ERROR(strSection, strItem, bReturn);
			}
		}
	}


	for (int i=0; i<DEF_MAX_THANDLER_VAC; i++)
	{
		strItem.Format(_T("UseTHandlerVac[%d]"), i);
		if (!GetValue(strSection, strItem, &m_bUseTHandlerVac[i]))
		{
			m_bUseTHandlerVac[i] = TRUE;
			DISPLAY_READ_ERROR(strSection, strItem, bReturn);
		}
	}


	/** Run Mode Status */
	//NSMC KJS
	//檗雖 跤ц擊 唳辦 default 籀葬
	CString		strTemp;
	if (!GetValue(strSection, _T("RunMode"), &strTemp))
	{
		m_eRunMode = NORMAL_RUN_MODE;
	}
	else
	{
		if (strTemp.Compare(_T("PASS")) == 0)
			m_eRunMode = PASS_RUN_MODE;
		else if (strTemp.Compare(_T("DRY")) == 0)
			m_eRunMode = DRY_RUN_MODE;
		else if (strTemp.Compare(_T("REPAIR")) == 0)
			m_eRunMode = REPAIR_RUN_MODE;
		else
			m_eRunMode = NORMAL_RUN_MODE;
	}

	return bReturn;
}

/** Data蒂 File縑 噙朝 螃朝 л熱 */
BOOL MPanelData::WriteData()
{
	if (!MakeBackUpFile())
	{
		// 檜晦 熱薑
		//Back Up File擊 虜萄朝等 褒ぬ ц蝗棲棻. 啗樓 霞ч ж啊蝗棲梱?
		if (MyMessageBox(MY_MESSAGE_BOX,10000, _T("File Write Error"), M_ICONERROR|M_YESNO) == IDNO) 
			return FALSE;
	}

	BOOL bReturn = TRUE;
	CString strValue;
	CString strSection = "Panel Data";

	if (!SetValue(strSection, "PanelSize_X", m_dPanelSize_X))
		DISPLAY_WRITE_ERROR(strSection, "PanelSize_X", bReturn);
	
	if (!SetValue(strSection, "PanelSize_Y", m_dPanelSize_Y))
		DISPLAY_WRITE_ERROR(strSection, "PanelSize_Y", bReturn);

	strValue = (m_bUseFlag_Xu) ? _T("TRUE") : _T("FALSE");
	if (!SetValue(strSection, "Use_Xu", strValue.GetBuffer(strValue.GetLength())))
		DISPLAY_WRITE_ERROR(strSection, "Use_Xu", bReturn);

	strValue = (m_bUseFlag_SubMark_Xu) ? _T("TRUE") : _T("FALSE");
	if (!SetValue(strSection, "Use_SubMark_Xu", strValue.GetBuffer(strValue.GetLength())))
		DISPLAY_WRITE_ERROR(strSection, "Use_SubMark_Xu", bReturn);
	
	if (!SetValue(strSection, "FiduMark_Xu_Pos_X", m_dX_FiduMark_Xu))
		DISPLAY_WRITE_ERROR(strSection, "FiduMark_Xu_Pos_X", bReturn);

	if (!SetValue(strSection, "FiduMark_Xu_Pos_Y", m_dY_FiduMark_Xu))
		DISPLAY_WRITE_ERROR(strSection, "FiduMark_Xu_Pos_Y", bReturn);

	if (!SetValue(strSection, "FiduMark_Xu_Distance", m_dDistance_FiduMark_Xu))
		DISPLAY_WRITE_ERROR(strSection, "FiduMark_Xu_Distance", bReturn);

	if (!SetValue(strSection, "FiduSubMark_Xu_Pos_X", m_dX_FiduSubMark_Xu))
		DISPLAY_WRITE_ERROR(strSection, "FiduSubMark_Xu_Pos_X", bReturn);

	if (!SetValue(strSection, "FiduSubMark_Xu_Pos_Y", m_dY_FiduSubMark_Xu))
		DISPLAY_WRITE_ERROR(strSection, "FiduSubMark_Xu_Pos_Y", bReturn);

	if (!SetValue(strSection, "FiduSubMark_Xu_Distance", m_dDistance_FiduSubMark_Xu))
		DISPLAY_WRITE_ERROR(strSection, "FiduSubMark_Xu_Distance", bReturn);

	if (!SetValue(strSection, "MarkDist_PanelToTab_Xu", m_dMarkDist_PanelToTab_Xu))
		DISPLAY_WRITE_ERROR(strSection, "MarkDist_PanelToTab_Xu", bReturn);

	strValue = (m_bUseFlag_Xd) ? _T("TRUE") : _T("FALSE");
	if (!SetValue(strSection, "Use_Xd", strValue.GetBuffer(strValue.GetLength())))
		DISPLAY_WRITE_ERROR(strSection, "Use_Xd", bReturn);

	strValue = (m_bUseFlag_SubMark_Xd) ? _T("TRUE") : _T("FALSE");
	if (!SetValue(strSection, "Use_SubMark_Xd", strValue.GetBuffer(strValue.GetLength())))
		DISPLAY_WRITE_ERROR(strSection, "Use_SubMark_Xd", bReturn);

	if (!SetValue(strSection, "FiduMark_Xd_Pos_X", m_dX_FiduMark_Xd))
		DISPLAY_WRITE_ERROR(strSection, "FiduMark_Xd_Pos_X", bReturn);

	if (!SetValue(strSection, "FiduMark_Xd_Pos_Y", m_dY_FiduMark_Xd))
		DISPLAY_WRITE_ERROR(strSection, "FiduMark_Xd_Pos_Y", bReturn);

	if (!SetValue(strSection, "FiduMark_Xd_Distance", m_dDistance_FiduMark_Xd))
		DISPLAY_WRITE_ERROR(strSection, "FiduMark_Xd_Distance", bReturn);

	if (!SetValue(strSection, "FiduSubMark_Xd_Pos_X", m_dX_FiduSubMark_Xd))
		DISPLAY_WRITE_ERROR(strSection, "FiduSubMark_Xd_Pos_X", bReturn);

	if (!SetValue(strSection, "FiduSubMark_Xd_Pos_Y", m_dY_FiduSubMark_Xd))
		DISPLAY_WRITE_ERROR(strSection, "FiduSubMark_Xd_Pos_Y", bReturn);

	if (!SetValue(strSection, "FiduSubMark_Xd_Distance", m_dDistance_FiduSubMark_Xd))
		DISPLAY_WRITE_ERROR(strSection, "FiduSubMark_Xd_Distance", bReturn);

	if (!SetValue(strSection, "MarkDist_PanelToTab_Xd", m_dMarkDist_PanelToTab_Xd))
		DISPLAY_WRITE_ERROR(strSection, "MarkDist_PanelToTab_Xd", bReturn);

	strValue = (m_bUseFlag_Yl) ? _T("TRUE") : _T("FALSE");
	if (!SetValue(strSection, "Use_Yl", strValue.GetBuffer(strValue.GetLength())))
		DISPLAY_WRITE_ERROR(strSection, "Use_Yl", bReturn);

	strValue = (m_bUseFlag_SubMark_Yl) ? _T("TRUE") : _T("FALSE");
	if (!SetValue(strSection, "Use_SubMark_Yl", strValue.GetBuffer(strValue.GetLength())))
		DISPLAY_WRITE_ERROR(strSection, "Use_SubMark_Yl", bReturn);

	if (!SetValue(strSection, "FiduMark_Yl_Pos_X", m_dX_FiduMark_Yl))
		DISPLAY_WRITE_ERROR(strSection, "FiduMark_Yl_Pos_X", bReturn);

	if (!SetValue(strSection, "FiduMark_Yl_Pos_Y", m_dY_FiduMark_Yl))
		DISPLAY_WRITE_ERROR(strSection, "FiduMark_Yl_Pos_Y", bReturn);

	if (!SetValue(strSection, "FiduMark_Yl_Distance", m_dDistance_FiduMark_Yl))
		DISPLAY_WRITE_ERROR(strSection, "FiduMark_Yl_Distance", bReturn);

	if (!SetValue(strSection, "FiduSubMark_Yl_Pos_X", m_dX_FiduSubMark_Yl))
		DISPLAY_WRITE_ERROR(strSection, "FiduSubMark_Yl_Pos_X", bReturn);

	if (!SetValue(strSection, "FiduSubMark_Yl_Pos_Y", m_dY_FiduSubMark_Yl))
		DISPLAY_WRITE_ERROR(strSection, "FiduSubMark_Yl_Pos_Y", bReturn);

	if (!SetValue(strSection, "FiduSubMark_Yl_Distance", m_dDistance_FiduSubMark_Yl))
		DISPLAY_WRITE_ERROR(strSection, "FiduSubMark_Yl_Distance", bReturn);

	if (!SetValue(strSection, "MarkDist_PanelToTab_Yl", m_dMarkDist_PanelToTab_Yl))
		DISPLAY_WRITE_ERROR(strSection, "MarkDist_PanelToTab_Yl", bReturn);

	strValue = (m_bUseFlag_Yr) ? _T("TRUE") : _T("FALSE");
	if (!SetValue(strSection, "Use_Yr", strValue.GetBuffer(strValue.GetLength())))
		DISPLAY_WRITE_ERROR(strSection, "Use_Yr", bReturn);
	
	strValue = (m_bUseFlag_SubMark_Yr) ? _T("TRUE") : _T("FALSE");
	if (!SetValue(strSection, "Use_SubMark_Yr", strValue.GetBuffer(strValue.GetLength())))
		DISPLAY_WRITE_ERROR(strSection, "Use_SubMark_Yr", bReturn);
	
	if (!SetValue(strSection, "FiduMark_Yr_Pos_X", m_dX_FiduMark_Yr))
		DISPLAY_WRITE_ERROR(strSection, "FiduMark_Yr_Pos_X", bReturn);

	if (!SetValue(strSection, "FiduMark_Yr_Pos_Y", m_dY_FiduMark_Yr))
		DISPLAY_WRITE_ERROR(strSection, "FiduMark_Yr_Pos_Y", bReturn);

	if (!SetValue(strSection, "FiduMark_Yr_Distance", m_dDistance_FiduMark_Yr))
		DISPLAY_WRITE_ERROR(strSection, "FiduMark_Yr_Distance", bReturn);

	if (!SetValue(strSection, "FiduSubMark_Yr_Pos_X", m_dX_FiduSubMark_Yr))
		DISPLAY_WRITE_ERROR(strSection, "FiduSubMark_Yr_Pos_X", bReturn);

	if (!SetValue(strSection, "FiduSubMark_Yr_Pos_Y", m_dY_FiduSubMark_Yr))
		DISPLAY_WRITE_ERROR(strSection, "FiduSubMark_Yr_Pos_Y", bReturn);

	if (!SetValue(strSection, "FiduSubMark_Yr_Distance", m_dDistance_FiduSubMark_Yr))
		DISPLAY_WRITE_ERROR(strSection, "FiduSubMark_Yr_Distance", bReturn);

	if (!SetValue(strSection, "MarkDist_PanelToTab_Yr", m_dMarkDist_PanelToTab_Yr))
		DISPLAY_WRITE_ERROR(strSection, "MarkDist_PanelToTab_Yr", bReturn);

	strValue = (m_ePanel_InDirection == INPUT_DIRECTION_NORMAL) ? _T("NORMAL") : _T("REVERSE");
	if (!SetValue(strSection, "Panel_Input_Direction", strValue.GetBuffer(strValue.GetLength())))
		DISPLAY_WRITE_ERROR(strSection, "Panel_Input_Direction", bReturn);
	
	strValue = (m_ePanel_OutDirection == OUTPUT_DIRECTION_NORMAL) ? _T("NORMAL") : _T("REVERSE");
	if (!SetValue(strSection, "Panel_Output_Direction", strValue.GetBuffer(strValue.GetLength())))
		DISPLAY_WRITE_ERROR(strSection, "Panel_Output_Direction", bReturn);
	
	if (!SetValue(strSection, "Panel_Thickness", m_dPanelThickness))
		DISPLAY_WRITE_ERROR(strSection, "Panel_Thickness", bReturn);

	if (!SetValue(strSection, "Panel_LowSide_Pol_Thickness", m_dPanelLowSidePolThickness))
		DISPLAY_WRITE_ERROR(strSection, "Panel_LowSide_Pol_Thickness", bReturn);
	
	//110114.kms
	/** Reference Data */
	if (!SetValue(strSection, "Reference_Data", m_strReferenceDevice))
		DISPLAY_WRITE_ERROR(strSection, "Reference_Data", bReturn);

//@#ifdef DEF_SOURCE_SYSTEM
//@	if (!SetValue(strSection, "PanelAlignMode", m_iPanelAlignMode))
//@		DISPLAY_WRITE_ERROR(strSection, "PanelAlignMode", bReturn);
//@#endif

	CString strItem;
	for (int i=0; i<DEF_MAX_WORK_SCHEDULE; i++)
	{
		for (int j=0; j<DEF_MAX_AIRVACUUM; j++)
		{
			strItem.Format(_T("UseAirVacuum_%d_%d"), i, j);
			if (!SetValue(m_strSection, strItem, m_bUseAirVacuum[i][j]))
			{
				DISPLAY_WRITE_ERROR(strSection, strItem, bReturn);
			}
		}
	}

	for (int i=0; i<DEF_MAX_THANDLER_VAC; i++)
	{
		strItem.Format(_T("UseTHandlerVac[%d]"), i);
		if (!SetValue(strSection, strItem, m_bUseTHandlerVac[i]))
			DISPLAY_READ_ERROR(strSection, strItem, bReturn);
	}


	/** Run Mode Status */
	//NSMC KJS 縑楝籀葬朝 ぬ蝶
	CString strTemp;
	if (m_eRunMode == PASS_RUN_MODE)
		strTemp.Format(_T("PASS"));
	else if (m_eRunMode == DRY_RUN_MODE)
		strTemp.Format(_T("DRY"));
	else if (m_eRunMode == REPAIR_RUN_MODE)
		strTemp.Format(_T("REPAIR"));
	else
		strTemp.Format(_T("NORMAL"));
	if (!SetValue(strSection, "RunMode",strTemp))
	{
		;
	}

	if (!bReturn)
	{
		char eMsg[200];
		char eMsg1[200];
		memset(eMsg, 0, sizeof(eMsg));
		memset(eMsg1, 0, sizeof(eMsg1));
		sprintf(eMsg, "%s File is an incorrect.", LPSTR(LPCTSTR(m_strFileName)));
		sprintf(eMsg1, "%s File Write Error!", LPSTR(LPCTSTR(m_strFileName)));
		MyMessageBox(eMsg, eMsg1, M_ICONERROR);
		return FALSE;
	}
	
	return bReturn;
}
/* End Of Code */